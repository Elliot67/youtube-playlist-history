name: "Auto save playlist"

on:
  workflow_dispatch:
  schedule:
  - cron: "0 0 * * 1"

jobs:
  execute:
    runs-on: ubuntu-latest

    steps:

      - name: Download youtube-dl
        run : |
          sudo curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl
          sudo chmod a+rx /usr/local/bin/youtube-dl
          sudo youtube-dl --update

      - name: Clone repo
        uses: actions/checkout@v2

      - name: Generate file
        run: |
          youtube-dl --skip-download --get-title --get-id --no-warnings --verbose --no-mark-watched --ignore-errors --no-warnings --geo-bypass --no-progress https://www.youtube.com/playlist?list=${{ secrets.PLAYLIST_ID }} > playlist.txt

      - name: Setup git config
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "<>"

      - name: Commit the file
        run: |
          git add playlist.txt
          git commit -m "ðŸ¤– update playlist tracks list"
          git push origin main
